<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <meta name="author" content="leo.park" />
    <title>ì•„ë¬´ë§ ëŒ€ì”ì¹˜</title>
    <style>
        /* ì „ì²´ ìŠ¤íƒ€ì¼ */
        * {
            font-family: 'Noto Sans KR', sans-serif;
            max-width: 100%;
            margin: 0;
            padding: 0;
            background-color: #fff
        }

        body {
            background-color: #f5f6f7;
            line-height: 1.6;
        }

        /* ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ */
        .container {
            max-width: 800px;
            margin: 30px auto;
            padding: 20px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        /* ì‚¬ìš©ì ì…ë ¥ í¼ ìŠ¤íƒ€ì¼ */
        .form-title {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 24px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #007bff;
        }

        textarea {
            min-height: 150px;
            resize: vertical;
        }

        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        button {
            padding: 12px 24px;
            background-color: #ACA0EB;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        button:hover {
            background-color: #7F6AEE;
        }

        button.secondary {
            background-color: #6c757d;
        }

        button.secondary:hover {
            background-color: #545b62;
        }



        /* ê²Œì‹œê¸€ ëª©ë¡ ìŠ¤íƒ€ì¼ */
        .posts-container {
            margin-top: 20px;
        }

        .post-item {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            background-color: white;
        }

        .post-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .post-item h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 18px;
        }

        .post-meta {
            color: #666;
            font-size: 14px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #eee;
        }

        /* í—¤ë” ìŠ¤íƒ€ì¼ */
        /* í—¤ë” ìŠ¤íƒ€ì¼ */
        .header {
            text-align: center;
            padding: 20px;
            border-bottom: 1px solid #eee;
        }

        .header-listTemplate {
            word-break: keep-all;
            width: 100%;
        }

        .title {
            color: #333;
            font-size: 24px;
            margin: 0;
        }

        /* ìƒì„¸ í˜ì´ì§€ ìŠ¤íƒ€ì¼ */
        #postDetailPage .post-content {
            margin: 20px 0;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
            min-height: 200px;
        }


        /* ë„¤ë¹„ê²Œì´ì…˜ ë°” ìŠ¤íƒ€ì¼ */
        .navigation {
            background-color: #fff;
            padding: 1rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .nav-brand {
            font-size: 1.5rem;
            font-weight: bold;
            color: #007bff;
        }

        .nav-items {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        /* ëŒ“ê¸€ ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .comments-section {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid #eee;
        }

        .comments-section h3 {
            margin-bottom: 1rem;
            color: #333;
        }

        .comment-item {
            padding: 1rem;
            border: 1px solid #eee;
            border-radius: 4px;
            margin-bottom: 1rem;
            background-color: #f8f9fa;
        }

        .comment-content {
            margin-bottom: 0.5rem;
        }

        .comment-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
            color: #666;
        }

        /* ë²„íŠ¼ ë³€í˜• */
        button.danger {
            background-color: #dc3545;
        }

        button.danger:hover {
            background-color: #c82333;
        }

        button.small {
            padding: 4px 8px;
            font-size: 0.8rem;
        }

        .button-listTemplate {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 20px;
            width: 100%;
            clear: both;
        }


        /* í¼ ë ˆì´ë¸” ìŠ¤íƒ€ì¼ */
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: #495057;
            font-weight: 500;
        }

        /* í”„ë¡œí•„ í˜ì´ì§€ ìŠ¤íƒ€ì¼ */
        .profile-info {
            background-color: #f8f9fa;
            padding: 1rem;
            border-radius: 4px;
            margin-bottom: 1rem;
        }

        /* ê²Œì‹œê¸€ ì•¡ì…˜ ë²„íŠ¼ */
        .post-actions {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #eee;
        }

        /* ê²Œì‹œíŒ ë°˜ì‘ ë²„íŠ¼(ì¢‹ì•„ìš”, ëŒ“ê¸€, ì¡°íšŒ) */
        .post-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
            font-size: 14px;
            color: #555;
        }

        .post-stats button {
            background-color: #4CAF50;
            /* ë²„íŠ¼ ìƒ‰ìƒ */
            color: white;
            /* ê¸€ì ìƒ‰ìƒ */
            border: none;
            padding: 8px 12px;
            cursor: pointer;
        }

        .post-stats button:hover {
            background-color: #45a049;
            /* ë²„íŠ¼ hover ì‹œ ìƒ‰ìƒ */
        }


        /* ë°˜ì‘í˜• ë””ìì¸ ë³´ì™„ */
        @media (max-width: 768px) {
            .nav-items {
                flex-direction: column;
                gap: 0.5rem;
            }

            .comment-meta {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
        }

        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                padding: 15px;
            }

            button {
                width: 100%;
                margin-bottom: 10px;
            }

            .header {
                flex-direction: column;
                align-items: flex-start;
            }

            .header button {
                margin-top: 10px;
            }
        }
    </style>
</head>

<body>
    <div id="app"></div>
    <script>
        // utils.js

        // app.js
        class Store {
            constructor() {
                this.state = {
                    currentPage: 'login',
                    isLoggedIn: false,
                    currentUser: null,
                    posts: [
                        {
                            id: 1,
                            title: 'ì•„ë¬´ë§ ëŒ€ì”ì¹˜ ê²Œì‹œíŒì˜ ê²Œì‹œê¸€ì…ë‹ˆë‹¤.',
                            content: 'í™˜ì˜í•©ë‹ˆë‹¤!',
                            author: 'ê´€ë¦¬ì',
                            date: '2024-10-30 14:52:23',
                            comments: [
                                { id: 1, content: 'ì•„ë¬´ë§ ëŒ€ì”ì¹˜ ê²Œì‹œíŒì˜ ëŒ“ê¸€ì…ë‹ˆë‹¤.', author: 'ê´€ë¦¬ì', date: '2024-10-30 14:52:23' }
                            ]
                        }
                    ],
                    selectedPost: null,
                    users: [
                        {
                            username: 'admin',
                            password: '1234',
                            nickname: 'ê´€ë¦¬ì',
                            email: 'admin@example.com',
                            joinDate: '2024-10-30 14:52:23'
                        }
                    ],
                    editMode: false
                };
            }

            // ê¸°ì¡´ ë©”ì„œë“œë“¤...
            setState(newState) {
                this.state = { ...this.state, ...newState };
                this.render();
            }

            render() {
                const app = document.getElementById('app');
                app.innerHTML = this.getPage();
            }

            getState() {
                return this.state;
            }



            login() {
                const username = document.getElementById('loginUsername').value;
                const password = document.getElementById('loginPassword').value;

                const user = this.state.users.find(u =>
                    u.username === username && u.password === password
                );

                if (user) {
                    this.setState({
                        isLoggedIn: true,
                        currentUser: user,
                        currentPage: 'list'
                    });
                } else {
                    alert('ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.');
                }
            }

            register() {
                const username = document.getElementById('registerUsername').value.trim(); // ì´ë©”ì¼
                const password = document.getElementById('registerPassword').value; // ë¹„ë°€ë²ˆí˜¸
                const passwordAgain = document.getElementById('registerPasswordagain').value; // ë¹„ë°€ë²ˆí˜¸ í™•ì¸
                const nickname = document.getElementById('registerNickname').value.trim(); // ë‹‰ë„¤ì„

                // ì´ë©”ì¼ ìœ íš¨ì„± ê²€ì‚¬
                if (!username) {
                    alert('*ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }

                const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
                if (username.length < 5 || !emailPattern.test(username)) {
                    alert('*ì˜¬ë°”ë¥¸ ì´ë©”ì¼ ì£¼ì†Œ í˜•ì‹ì„ ì…ë ¥í•´ì£¼ì„¸ìš”(ì˜ˆ: example@example.com)');
                    return;
                }

                // ì¤‘ë³µ ì´ë©”ì¼ í™•ì¸
                if (this.state.users.some(u => u.username === username)) {
                    alert('*ì¤‘ë³µëœ ì´ë©”ì¼ì…ë‹ˆë‹¤.');
                    return;
                }

                // ë¹„ë°€ë²ˆí˜¸ ìœ íš¨ì„± ê²€ì‚¬
                if (!password) {
                    alert('*ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }

                const passwordPattern = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*])[A-Za-z\d!@#$%^&*]{8,20}$/;
                if (!passwordPattern.test(password)) {
                    alert('*ë¹„ë°€ë²ˆí˜¸ëŠ” 8ì ì´ìƒ, 20ì ì´í•˜ì´ë©°, ëŒ€ë¬¸ì, ì†Œë¬¸ì, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ìë¥¼ ê°ê° ìµœì†Œ 1ê°œ í¬í•¨í•´ì•¼í•©ë‹ˆë‹¤.');
                    return;
                }

                if (!passwordAgain) {
                    alert('*ë¹„ë°€ë²ˆí˜¸ë¥¼ í•œë²ˆ ë” ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }

                if (password !== passwordAgain) {
                    alert('*ë¹„ë°€ë²ˆí˜¸ê°€ ë‹¤ë¦…ë‹ˆë‹¤.');
                    return;
                }

                // ë‹‰ë„¤ì„ ìœ íš¨ì„± ê²€ì‚¬
                if (!nickname) {
                    alert('*ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }

                if (nickname.length > 10) {
                    alert('*ë‹‰ë„¤ì„ì€ ìµœëŒ€ 10ìê¹Œì§€ ì‘ì„±ê°€ëŠ¥í•©ë‹ˆë‹¤.');
                    return;
                }

                if (/\s/.test(nickname)) {
                    alert('*ë„ì–´ì“°ê¸°ë¥¼ ì—†ì• ì£¼ì„¸ìš”.');
                    return;
                }

                if (this.state.users.some(u => u.nickname === nickname)) {
                    alert('*ì¤‘ë³µëœ ë‹‰ë„¤ì„ì…ë‹ˆë‹¤.');
                    return;
                }

                // ìƒˆ ì‚¬ìš©ì ì¶”ê°€
                const newUser = { username, password, nickname };
                this.setState({
                    users: [...this.state.users, newUser],
                    currentPage: 'login'
                });
                alert('íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');
            }

            logout() {
                this.setState({
                    isLoggedIn: false,
                    currentUser: null,
                    currentPage: 'login'
                });
            }

            viewPost(id) {
                const post = this.state.posts.find(p => p.id === id);
                if (post) {
                    this.setState({
                        selectedPost: post,
                        currentPage: 'detail'
                    });
                }
            }

            savePost() {
                const title = document.getElementById('postTitle').value;
                const content = document.getElementById('postContent').value;

                if (!title || !content) {
                    alert('ì œëª©ê³¼ ë‚´ìš©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }

                const newPost = {
                    id: this.state.posts.length + 1,
                    title,
                    content,
                    author: this.state.currentUser.nickname,
                    // date: new Date().toISOString().replace('T', ' ').slice(0, 19)
                    date: new Date().toLocaleString('ko-KR', {
                        year: 'numeric',
                        month: '2-digit',
                        day: '2-digit',
                        hour: '2-digit',
                        minute: '2-digit',
                        second: '2-digit',
                        hour12: false
                    })
                };

                this.setState({
                    posts: [...this.state.posts, newPost],
                    currentPage: 'list'
                });
            }

            getPage() {
                switch (this.state.currentPage) {
                    case 'login':
                        return this.loginTemplate();
                    case 'register':
                        return this.registerTemplate();
                    case 'list':
                        return this.listTemplate();
                    case 'detail':
                        return this.detailTemplate();
                    case 'write':
                        return this.writeTemplate();
                    case 'profile':
                        return this.profileTemplate();
                    case 'edit':
                        return this.editTemplate();
                    default:
                        return this.loginTemplate();
                }
            }

            loginTemplate() {
                return `
            <div class="container">
                <h2 class="form-title">ë¡œê·¸ì¸</h2>
                <div class="form-group">
                    <input type="text" id="loginUsername" placeholder="ì´ë©”ì¼" autocomplete="username" />
                </div>
                <div class="form-group">
                    <input type="password" id="loginPassword" placeholder="ë¹„ë°€ë²ˆí˜¸" autocomplete="current-password" />
                </div>
                <div style="text-align: center;">
                    <button onclick="store.login()">ë¡œê·¸ì¸</button>
                    <button class="secondary" onclick="store.setState({ currentPage: 'register' })">íšŒì›ê°€ì…</button>
                </div>
            </div>
        `;
            }

            registerTemplate() {
                return `
            <div class="container">
                <h2 class="form-title">íšŒì›ê°€ì…</h2>
                <div class="form-group">
                    <input type="text" id="registerUsername" placeholder="ì´ë©”ì¼" />
                </div>
                <div class="form-group">
                    <input type="password" id="registerPassword" placeholder="ë¹„ë°€ë²ˆí˜¸" />
                </div>
                <div class="form-group">
                    <input type="password" id="registerPasswordagain" placeholder="ë¹„ë°€ë²ˆí˜¸ í™•ì¸" />
                </div>
                <div class="form-group">
                    <input type="text" id="registerNickname" placeholder="ë‹‰ë„¤ì„" />
                </div>
                <div style="text-align: center;">
                    <button onclick="store.register()">íšŒì›ê°€ì…</button>
                    <button class="secondary" onclick="store.setState({ currentPage: 'login' })">ë¡œê·¸ì¸í•˜ëŸ¬ ê°€ê¸°</button>
                </div>
            </div>
        `;
            }

            listTemplate() {
                const { posts } = this.state;
                return `
            <div class="container">
                <div id="postListPage" class="active">
                    <div class="header-listTemplate">
                        <h2 class="title">ì•ˆë…•í•˜ì„¸ìš” ì•„ë¬´ë§ ëŒ€ì”ì¹˜ ê²Œì‹œíŒì…ë‹ˆë‹¤</h2>
                        <div class="button-listTemplate">
                            <button onclick="store.setState({ currentPage: 'write' })">ê²Œì‹œê¸€ ì‘ì„±</button>
                            <button onclick="store.setState({ currentPage: 'profile' })">í”„ë¡œí•„ ê´€ë¦¬</button>
                            <button class="secondary" onclick="store.logout()">ë¡œê·¸ì•„ì›ƒ</button>
                        </div>
                    </div>
                    <div class="posts-container">
                        ${posts.map(post => `
                            <div class="post-item" onclick="store.viewPost(${post.id})">
                                <h3>${post.title}</h3>
                                <div class="post-meta">
                                    <span>ì‘ì„±ì: ${post.author}</span>
                                    <span>ì‘ì„±ì¼: ${post.date}</span>
                                    <span>ì¢‹ì•„ìš”: ${post.likes || '0'}</span>
                                    <span>ëŒ“ê¸€ìˆ˜: ${post.commentsCount || '0'}</span>
                                    <span>ì¡°íšŒìˆ˜: ${post.views || '0'}</span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            </div>
        `;
            }

            // íšŒì›ì •ë³´ í˜ì´ì§€ í…œí”Œë¦¿
            profileTemplate() {
                const { currentUser } = this.state;
                return `
            <div class="container">
                <div class="header">
                    <h2 class="title">íšŒì›ì •ë³´ìˆ˜ì •</h2>
                </div>
                <div class="form-group">
                    <label>ì´ë©”ì¼</label>
                    <input type="text" value="${currentUser.username}" disabled />
                </div>
                <div class="form-group">
                    <label>ë‹‰ë„¤ì„</label>
                    <input type="text" id="profileNickname" value="${currentUser.nickname}" />
                </div>
                <!--
                <div class="form-group">
                    <label>ì´ë©”ì¼</label>
                    <input type="email" id="profileEmail" value="${currentUser.email || ''}" />
                </div>
                -->
                <div class="form-group">
                    <label>ìƒˆ ë¹„ë°€ë²ˆí˜¸</label>
                    <input type="password" id="newPassword" placeholder="ë³€ê²½ì‹œì—ë§Œ ì…ë ¥" />
                </div>
                <div style="text-align: right;">
                    <button onclick="store.updateProfile()">ìˆ˜ì •ì™„ë£Œ</button>
                    <button class="secondary" onclick="store.setState({ currentPage: 'list' })">ì·¨ì†Œ</button>
                </div>
            </div>
        `;
            }

            // ê²Œì‹œê¸€ ìˆ˜ì • í…œí”Œë¦¿
            editTemplate() {
                const { selectedPost } = this.state;
                return `
            <div class="container">
                <div class="header">
                    <h2 class="title">ê²Œì‹œê¸€ ìˆ˜ì •</h2>
                </div>
                <div class="form-group">
                    <input type="text" id="editTitle" value="${selectedPost.title}" />
                </div>
                <div class="form-group">
                    <textarea id="editContent">${selectedPost.content}</textarea>
                </div>
                <div style="text-align: right;">
                    <button onclick="store.updatePost()">ìˆ˜ì •</button>
                    <button class="secondary" onclick="store.setState({ currentPage: 'detail' })">ì·¨ì†Œ</button>
                </div>
            </div>
        `;
            }

            // ê²Œì‹œê¸€ ìƒì„¸ í˜ì´ì§€ ì—…ë°ì´íŠ¸ (ëŒ“ê¸€ ê¸°ëŠ¥ ì¶”ê°€)
            detailTemplate() {
                const { selectedPost, currentUser } = this.state;
                const likes = selectedPost.likes || 0; // ê¸°ë³¸ê°’ ì„¤ì •
                const commentsCount = selectedPost.comments ? selectedPost.comments.length : 0; // ëŒ“ê¸€ ìˆ˜ ê³„ì‚°
                const views = selectedPost.views || 0; // ì¡°íšŒìˆ˜ ê¸°ë³¸ê°’ ì„¤ì •

                // ìˆ˜ì¹˜ í˜•ì‹ì„ ì§€ì • í•¨ìˆ˜
                const formatCount = (count) => {
                    if (count >= 100000) {
                        return `${Math.floor(count / 1000)}k`;
                    } else if (count >= 10000) {
                        return `${Math.floor(count / 1000)}k`;
                    } else {
                        return count.toString();
                    }
                };

                return `
            <div class="container">
                <div id="postDetailPage">
                    <div class="header">
                        <h2 class="title">${selectedPost.title}</h2>
                        <div class="post-meta">
                            <div>ì‘ì„±ì: ${selectedPost.author}</div>
                            <div>ì‘ì„±ì¼: ${selectedPost.date}</div>
                        </div>
                    </div>
                    <div class="post-content">
                        ${selectedPost.content}
                    </div>

                    <!-- ì¢‹ì•„ìš”, ëŒ“ê¸€ ìˆ˜, ì¡°íšŒìˆ˜ -->
                    <div class="post-stats">
                    <button onclick="store.likePost()">ğŸ‘ ${formatCount(likes)} ì¢‹ì•„ìš”</button>
                    <span>${formatCount(commentsCount)} ëŒ“ê¸€ ìˆ˜</span>
                    <span>${formatCount(views)} ì¡°íšŒìˆ˜</span>
                    </div>

                    <div style="text-align: right;" class="post-actions">
                        <button onclick="store.setState({ currentPage: 'list' })">ëª©ë¡ìœ¼ë¡œ</button>
                        ${selectedPost.author === currentUser?.nickname ? `
                            <button onclick="store.setState({ currentPage: 'edit', editMode: true })">ìˆ˜ì •</button>
                            <button class="danger" onclick="store.deletePost(${selectedPost.id})">ì‚­ì œ</button>
                        ` : ''}
                    </div>
                    
                    <!-- ëŒ“ê¸€ ì„¹ì…˜ -->
                    <div class="comments-section">
                        <h3>ëŒ“ê¸€</h3>
                        <div class="form-group">
                            <textarea id="commentContent" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                            <button onclick="store.addComment()">ëŒ“ê¸€ ì‘ì„±</button>
                        </div>
                        <div class="comments-list">
                            ${selectedPost.comments ? selectedPost.comments.map(comment => `
                                <div class="comment-item">
                                    <div class="comment-content">${comment.content}</div>
                                    <div class="comment-meta">
                                        <span>${comment.author}</span>
                                        <span>${comment.date}</span>
                                        ${comment.author === currentUser?.nickname ?
                        `<button class="small danger" onclick="store.deleteComment(${comment.id})">ì‚­ì œ</button>`
                        : ''
                    }
                                    </div>
                                </div>
                            `).join('') : ''}
                        </div>
                    </div>
                </div>
            </div>
        `;
            }

            // ì¢‹ì•„ìš” ìˆ˜ì™€ ì¡°íšŒìˆ˜ ì¦ê°€
            likePost() {
                const updatedPost = {
                    ...this.state.selectedPost,
                    likes: (this.state.selectedPost.likes || 0) + 1, // ì¢‹ì•„ìš” ìˆ˜ ì¦ê°€
                    views: (this.state.selectedPost.views || 0) + 1  // ì¡°íšŒìˆ˜ë„ ì¦ê°€ (ì˜µì…˜)
                };

                this.setState({
                    selectedPost: updatedPost,
                    posts: this.state.posts.map(post => post.id === updatedPost.id ? updatedPost : post) // ìƒíƒœ ì—…ë°ì´íŠ¸
                });

                alert('ì¢‹ì•„ìš”ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!'); // ì•Œë¦¼ ì¶”ê°€ (ì„ íƒ ì‚¬í•­)
            }


            writeTemplate() {
                return `
            <div class="container">
                <div id="postWritePage">
                    <div class="header">
                        <h2 class="title">ê²Œì‹œê¸€ ì‘ì„±</h2>
                    </div>
                    <div class="form-group">
                        <input type="text" id="postTitle" placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”" />
                    </div>
                    <div class="form-group">
                        <textarea id="postContent" placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                    </div>
                    <div style="text-align: right;">
                        <button onclick="store.savePost()">ì €ì¥í•˜ê¸°</button>
                        <button class="secondary" onclick="store.setState({ currentPage: 'list' })">ì·¨ì†Œ</button>
                    </div>
                </div>
            </div>
        `;
            }


            // íšŒì›ì •ë³´ìˆ˜ì •
            updateProfile() {
                const nickname = document.getElementById('profileNickname').value;
                const email = document.getElementById('profileEmail').value;
                const newPassword = document.getElementById('newPassword').value;

                if (!nickname) {
                    alert('ë‹‰ë„¤ì„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.');
                    return;
                }

                const updatedUser = {
                    ...this.state.currentUser,
                    nickname,
                    email
                };

                if (newPassword) {
                    updatedUser.password = newPassword;
                }

                const users = this.state.users.map(user =>
                    user.username === updatedUser.username ? updatedUser : user
                );

                this.setState({
                    users,
                    currentUser: updatedUser,
                    currentPage: 'list'
                });

                alert('í”„ë¡œí•„ì´ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.');
            }

            // ê²Œì‹œê¸€ ìˆ˜ì •
            updatePost() {
                const title = document.getElementById('editTitle').value;
                const content = document.getElementById('editContent').value;

                if (!title || !content) {
                    alert('ì œëª©ê³¼ ë‚´ìš©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }

                const updatedPost = {
                    ...this.state.selectedPost,
                    title,
                    content,
                    date: new Date().toLocaleString('ko-KR', {
                        year: 'numeric',
                        month: '2-digit',
                        day: '2-digit',
                        hour: '2-digit',
                        minute: '2-digit',
                        second: '2-digit',
                        hour12: false
                    })
                };

                const posts = this.state.posts.map(post =>
                    post.id === updatedPost.id ? updatedPost : post
                );

                this.setState({
                    posts,
                    selectedPost: updatedPost,
                    currentPage: 'detail',
                    editMode: false
                });

                alert('ê²Œì‹œê¸€ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.');
            }

            // ê²Œì‹œê¸€ ì‚­ì œ
            deletePost(id) {
                if (!confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

                const posts = this.state.posts.filter(post => post.id !== id);
                this.setState({
                    posts,
                    currentPage: 'list'
                });

                alert('ê²Œì‹œê¸€ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
            }

            // ëŒ“ê¸€ ì¶”ê°€
            addComment() {
                const content = document.getElementById('commentContent').value;
                if (!content) {
                    alert('ëŒ“ê¸€ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }

                const newComment = {
                    id: new Date().getTime(),
                    content,
                    author: this.state.currentUser.nickname,
                    date: new Date().toLocaleString('ko-KR', {
                        year: 'numeric',
                        month: '2-digit',
                        day: '2-digit',
                        hour: '2-digit',
                        minute: '2-digit',
                        second: '2-digit',
                        hour12: false
                    })
                };

                const updatedPost = {
                    ...this.state.selectedPost,
                    comments: [...(this.state.selectedPost.comments || []), newComment],
                    commentsCount: ((this.state.selectedPost.commentsCount || 0) + 1) // ëŒ“ê¸€ ìˆ˜ ì¦ê°€
                };

                const posts = this.state.posts.map(post =>
                    post.id === updatedPost.id ? updatedPost : post
                );

                this.setState({
                    posts,
                    selectedPost: updatedPost
                });

                document.getElementById('commentContent').value = '';
            }

            // ëŒ“ê¸€ ì‚­ì œ
            deleteComment(commentId) {
                if (!confirm('ëŒ“ê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

                const updatedPost = {
                    ...this.state.selectedPost,
                    comments: this.state.selectedPost.comments.filter(comment => comment.id !== commentId)
                };

                const posts = this.state.posts.map(post =>
                    post.id === updatedPost.id ? updatedPost : post
                );

                this.setState({
                    posts,
                    selectedPost: updatedPost
                });
            }

            // ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜ ë°” ì¶”ê°€(ì¼ë‹¨ ë³´ë¥˜)
            getNavigation() {
                const { currentUser } = this.state;
                const nickname = currentUser ? currentUser.nickname : 'ì‚¬ìš©ì';
                return `
            <nav class="navigation">
                <div class="nav-brand">ì»¤ë®¤ë‹ˆí‹°</div>
                <div class="nav-items">
                    <span>í™˜ì˜í•©ë‹ˆë‹¤, ${currentUser.nickname}ë‹˜!</span>
                    <button onclick="store.setState({ currentPage: 'profile' })">í”„ë¡œí•„</button>
                    <button class="secondary" onclick="store.logout()">ë¡œê·¸ì•„ì›ƒ</button>
                </div>
            </nav>
        `;
            }


        }

        // Store ì´ˆê¸°í™” ë° ë Œë”ë§
        document.addEventListener('DOMContentLoaded', () => {
            window.store = new Store();
            store.render();
        });

    </script>
</body>

</html>